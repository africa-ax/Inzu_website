<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INZU ‚Äî Professional Directory & Engineering Verification</title>
    <style>
        :root {
            --primary-color: #006837;
            --primary-dark: #004d29;
            --secondary-color: #1a1a1a;
            --text-main: #2d3436;
            --text-light: #636e72;
            --bg-light: #f8fafc;
            --white: #ffffff;
            --accent-border: #e2e8f0;
            --verified-blue: #007bff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-light); color: var(--text-main); line-height: 1.6; }

        header { background: var(--white); height: 80px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 100; display: flex; align-items: center; }
        .header-content { max-width: 1200px; width: 100%; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 0 24px; }
        .logo { font-size: 24px; font-weight: 800; color: var(--primary-color); text-decoration: none; }

        nav { display: flex; gap: 32px; }
        nav a { color: var(--text-main); text-decoration: none; font-weight: 500; font-size: 15px; }
        nav a:hover { color: var(--primary-color); }

        .menu-btn { background: none; border: none; font-size: 28px; cursor: pointer; display: none; }

        /* Mobile Menu */
        .mobile-menu { position: fixed; top: 0; right: 0; width: 300px; height: 100vh; background: var(--white); transform: translateX(100%); transition: transform 0.3s ease; z-index: 1000; box-shadow: -10px 0 30px rgba(0,0,0,0.1); }
        .mobile-menu.active { transform: translateX(0); }
        .mobile-menu nav { flex-direction: column; padding: 20px 0; gap: 0; }
        .mobile-menu nav a { padding: 16px 24px; border-bottom: 1px solid var(--bg-light); }

        .container { max-width: 1200px; margin: 0 auto; padding: 60px 24px; }
        .page-header { border-left: 4px solid var(--primary-color); padding-left: 24px; margin-bottom: 48px; }
        .page-title { font-size: 42px; font-weight: 800; color: var(--secondary-color); margin-bottom: 12px; }

        .register-btns { display: flex; gap: 16px; margin-top: 32px; }
        .register-btn { background: var(--primary-color); color: var(--white); padding: 14px 28px; border-radius: 4px; font-weight: 700; text-decoration: none; font-size: 14px; text-transform: uppercase; }

        .search-filters { background: var(--white); padding: 32px; border-radius: 8px; margin-bottom: 40px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); display: grid; grid-template-columns: 1fr 240px; gap: 16px; }
        .search-filters input, .search-filters select { padding: 14px; border: 1px solid var(--accent-border); border-radius: 4px; background: var(--bg-light); }

        .tabs { display: flex; gap: 32px; border-bottom: 1px solid var(--accent-border); margin-bottom: 40px; }
        .tab-btn { padding: 16px 0; border: none; background: none; cursor: pointer; font-weight: 700; color: var(--text-light); border-bottom: 3px solid transparent; }
        .tab-btn.active { color: var(--primary-color); border-bottom-color: var(--primary-color); }

        .professionals-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); gap: 24px; }
        .professional-card { background: var(--white); border-radius: 8px; padding: 32px; position: relative; transition: transform 0.3s; border: 1px solid transparent; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .professional-card:hover { transform: translateY(-5px); border-color: var(--accent-border); }

        .badge { position: absolute; top: 24px; right: 24px; padding: 4px 12px; border-radius: 4px; font-size: 11px; font-weight: 800; text-transform: uppercase; }
        .badge.verified { background: #dcfce7; color: #166534; }
        .badge.unverified { background: #fef3c7; color: #92400e; }

        .profile-header { display: flex; gap: 20px; margin-bottom: 24px; }
        .profile-photo { width: 72px; height: 72px; border-radius: 4px; object-fit: cover; background: var(--bg-light); }
        .profile-info h3 { font-size: 18px; font-weight: 800; }
        .service-type { color: var(--primary-color); font-weight: 700; font-size: 14px; text-transform: uppercase; }

        .action-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 24px; }
        .btn { padding: 12px; border-radius: 4px; font-weight: 700; text-align: center; text-decoration: none; font-size: 13px; text-transform: uppercase; cursor: pointer; }
        .btn-call { background: var(--bg-light); color: var(--secondary-color); border: 1px solid var(--accent-border); }
        .btn-whatsapp { background: #25D366; color: white; border: none; }

        @media (max-width: 768px) {
            .menu-btn { display: block; }
            nav { display: none; }
            .search-filters { grid-template-columns: 1fr; }
            .professionals-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="index.html" class="logo">INZU</a>
            <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
            <nav>
                <a href="index.html">Home</a>
                <a href="blogs.html">Insights</a>
                <a href="professionals.html">Directory</a>
                <a href="services.html">Services</a>
                <a href="jobs.html">Jobs</a>
            </nav>
        </div>
    </header>

    <div class="mobile-menu" id="mobileMenu">
        <nav>
            <a href="index.html">Home</a>
            <a href="blogs.html">Insights</a>
            <a href="professionals.html">Directory</a>
            <a href="services.html">Services</a>
            <a href="jobs.html">Jobs</a>
            <a href="#" onclick="toggleMenu()" style="color:red">Close Menu √ó</a>
        </nav>
    </div>

    <div class="container">
        <div class="page-header">
            <h1 class="page-title">Technical Directory</h1>
            <p>Access Rwanda's database of verified engineers and construction specialists.</p>
            <div class="register-btns">
                <a href="register-engineer.html" class="register-btn">Accredit as Engineer</a>
                <a href="register-worker.html" class="register-btn" style="background:var(--secondary-color)">Register Trade</a>
            </div>
        </div>

        <div class="search-filters">
            <input type="text" id="searchInput" placeholder="Search name or expertise...">
            <select id="districtFilter">
                <option value="">All Districts</option>
            </select>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('verified')">Certified Engineers</button>
            <button class="tab-btn" onclick="switchTab('unverified')">Specialized Trades</button>
        </div>

        <div id="professionalsContainer" class="professionals-grid">
            </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, query, orderBy, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyA8RRcGRfT3NW_u8j5Fqw0yN2EpjmNUoXg",
            authDomain: "shyaka-87ea8.firebaseapp.com",
            projectId: "shyaka-87ea8",
            storageBucket: "shyaka-87ea8.firebasestorage.app",
            messagingSenderId: "482987054954",
            appId: "1:482987054954:web:dbbce95e72104f52d87713"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let currentTab = 'verified';

        window.switchTab = (tab) => {
            currentTab = tab;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            loadProfessionals();
        };

        async function loadProfessionals() {
            const container = document.getElementById('professionalsContainer');
            container.innerHTML = '<p style="grid-column:1/-1; text-align:center">Loading technical database...</p>';
            
            try {
                const colName = currentTab === 'verified' ? 'engineers_verified' : 'workers_public';
                const q = query(collection(db, colName), orderBy('timestamp', 'desc'));
                const snap = await getDocs(q);
                
                if (snap.empty) {
                    container.innerHTML = '<p style="grid-column:1/-1; text-align:center">No records found.</p>';
                    return;
                }

                container.innerHTML = '';
                snap.forEach(doc => {
                    const p = doc.data();
                    const card = document.createElement('div');
                    card.className = 'professional-card';
                    card.innerHTML = `
                        <span class="badge ${currentTab === 'verified' ? 'verified' : 'unverified'}">${currentTab === 'verified' ? 'Certified' : 'Specialist'}</span>
                        <div class="profile-header">
                            <img src="${p.photoBase64 || 'https://via.placeholder.com/80'}" class="profile-photo">
                            <div class="profile-info">
                                <h3>${p.name}</h3>
                                <div class="service-type">${p.service}</div>
                                <div style="font-size:13px; color:gray">üìç ${p.district}</div>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <a href="tel:${p.phone}" class="btn btn-call">Call</a>
                            <a href="https://wa.me/250${p.phone.replace(/^0/, '')}" class="btn btn-whatsapp" target="_blank">WhatsApp</a>
                        </div>
                    `;
                    container.appendChild(card);
                });
            } catch (e) {
                container.innerHTML = '<p style="grid-column:1/-1; text-align:center; color:red">Error connecting to database.</p>';
            }
        }

        window.toggleMenu = () => document.getElementById('mobileMenu').classList.toggle('active');
        loadProfessionals();
    </script>
</body>
</html>